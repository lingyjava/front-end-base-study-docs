# 8·JS作用域

<!-- TOC -->
* [8·JS作用域](#8js作用域)
  * [介绍](#介绍)
  * [作用域分类](#作用域分类)
  * [变量作用域](#变量作用域)
  * [块级作用域 & 变量提升](#块级作用域--变量提升)
  * [作用域链](#作用域链)
  * [预解析](#预解析)
<!-- TOC -->

## 介绍
限定一个程序代码中的名字可用性的代码范围，这个范围就是作用域。作用域可以提高程序逻辑的局部性，减少名字冲突。

## 作用域分类
es6前：全局作用域、局部作用域。  
- 全局作用域：整个script标签 或 一个单独的js文件。
- 局部作用域：一个函数的内部是一个局部。

## 变量作用域
根据作用域的不同，变量分为：全局变量、局部变量。
- 全局变量：在全局作用域下的变量，在全局下都可以使用。
- 局部变量：在局部作用域下的变量，在函数内部定义的变量只能在函数内部使用。

使用注意：
- 在函数内部没有声明直接赋值的变量将隐式定义为全局变量。
- 函数的形参也属于局部变量。
- 全局变量只有关闭浏览器时销毁，比较占内存资源。
- 局部变量当程序执行完毕时销毁。

## 块级作用域 & 变量提升
在es6前，通常使用var关键字定义变量，但var将使变量提升，

变量提升：
- 变量在声明之前就可以使用，值为undefined，并且为全局变量。
- 在if for 等块中定义的变量隐式定义为全局变量，没有块级作用域。

在es6中，新增let和const关键字定义变量阻止了变量提升。将变量限制在块级作用域中。

## 作用域链
如果在函数的内部还有函数，那么这个作用域中就又产生了一个作用域。  
根据内部函数可以访问外部函数变量的机制，用链式查找哪些数据能被内部函数访问（就近原则），称为作用域链。

## 预解析
JS代码由JS解析器执行，解析器在运行JS代码时分为两步：预解析和代码执行。  

JS引擎进行预解析时将所有var和function提升到当前作用域的最前面。  
在代码执行时从上往下执行。  

- 变量预解析(提升)：把所有变量声明提升到当前作用域的最前。
- 函数预解析(提升)：把所有函数声明提升到当前作用域的最前。

使用注意：
- 变量的声明经过预解析提升到作用域最前，但变量的赋值并不会被提升。

